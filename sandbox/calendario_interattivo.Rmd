---
title: "test_calendar"
output: html_document
date: "2025-07-28"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Pagina {.tabset}

### R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

### Calendario

<div style="text-align: center; margin-bottom: 1em;">
  <button onclick="changeMonth(-1)">← Precedente</button>
  <button onclick="changeMonth(1)">Successivo →</button>
</div>

<div id="calendar-container"></div>

<script>
let displayDate = new Date();  // Global variable to track displayed month

function generateCalendar() {
  const year = displayDate.getFullYear();
  const month = displayDate.getMonth(); // 0 = Jan

  const firstDay = new Date(year, month, 1).getDay();
  const numDays = new Date(year, month + 1, 0).getDate();
  const keyPrefix = `${year}-${String(month + 1).padStart(2, '0')}`;

  let calendarHTML = `<table border="1" style="border-collapse:collapse; width:100%">`;
  calendarHTML += `<tr><th colspan="7">${displayDate.toLocaleString('default', { month: 'long' })} ${year}</th></tr>`;
  calendarHTML += `<tr><th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th></tr>`;

  let day = 1;
  for (let i = 0; i < 6 && day <= numDays; i++) {
    calendarHTML += "<tr>";
    for (let j = 0; j < 7; j++) {
      if ((i === 0 && j < firstDay) || day > numDays) {
        calendarHTML += `<td></td>`;
      } else {
        const inputId = `${keyPrefix}-${String(day).padStart(2, '0')}`;
        const savedValue = localStorage.getItem(inputId) || "";
        calendarHTML += `
          <td>
            <strong>${day}</strong><br>
            <input type="text" id="${inputId}" value="${savedValue}" style="width: 90%"/>
          </td>`;
        day++;
      }
    }
    calendarHTML += "</tr>";
  }
  calendarHTML += "</table>";

  document.getElementById("calendar-container").innerHTML = calendarHTML;

  // Save values on change
  const inputs = document.querySelectorAll("#calendar-container input");
  inputs.forEach(input => {
    input.addEventListener("input", (e) => {
      localStorage.setItem(e.target.id, e.target.value);
    });
  });
}

// Called when Prev/Next buttons are clicked
function changeMonth(offset) {
  displayDate.setMonth(displayDate.getMonth() + offset);
  generateCalendar();
}

document.addEventListener("DOMContentLoaded", generateCalendar);
</script>

<style>
#calendar-container table {
  font-family: sans-serif;
  margin: auto;
}
#calendar-container th {
  background-color: #f0f0f0;
  text-align: center;
}
#calendar-container td {
  text-align: center;
  vertical-align: top;
  padding: 5px;
  height: 100px;
}
#calendar-container input {
  margin-top: 5px;
}
</style>
